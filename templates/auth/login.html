{% extends "base.html" %}
{% block title %}Вход/Регистрация в веб-эмулятор{% endblock %}
{% block description %}Эмулятор компьютерной сети для образовательных целей на базе ОС Linux{% endblock %}
{% block content %}

<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, shrink-to-fit=no, viewport-fit=cover'>
  <meta http-equiv='X-UA-Compatible' content='ie=edge'>
  <meta http-equiv="Content-Security-Policy" content="frame-ancestors 'self' http://127.0.0.1:5000">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://login.yandex.ru; style-src 'self' 'unsafe-inline' https://login.yandex.ru;">
</head>

<section class="vh-100">
  <div class="container py-3 h-100">
    <div class="row d-flex align-items-center justify-content-center h-100">
      <div class="col-md-7 col-lg-5 col-xl-5 offset-xl-1">
        <h1 class="text-center">Добро пожаловать!</h1>

        <!--
                <p class="text-center">Не зарегистрированы?<a href="!#">Создайте аккаунт.</a></p>


                <form  class="needs-validation mb-2" novalidate="">

          <div class="position-relative mb-4">
                <label for="email" class="form-label fs-base">Электронная почта</label>
                <input type="email" id="email" class="form-control form-control-lg" required="">
                <div class="invalid-feedback position-absolute start-0 top-100">Please enter a valid email address!</div>
          </div>


          <div class="mb-4">
                <label for="password" class="form-label fs-base">Пароль</label>
                <div class="password-toggle">
                  <input type="password" id="password" class="form-control form-control-lg" required="">
                  <label class="password-toggle-btn" aria-label="Show/hide password">
                    <input class="password-toggle-check" type="checkbox">
                    <span class="password-toggle-indicator"></span>
                  </label>
                  <div class="invalid-feedback position-absolute start-0 top-100">Please enter your password!</div>
                </div>
          </div>


          <div class="mb-4">
                <div class="form-check">
                  <input type="checkbox" id="remember" class="form-check-input">
                  <label for="remember" class="form-check-label fs-base">Запомните меня</label>
                </div>
          </div>


            <div class="butt container">
             <div class="row">
                <button type="submit" class="btn btn-primary shadow-primary btn-lg w-100">Вход</button>
             </div>
            </div>
    </form>
                <a href="#" class="btn btn-link btn-lg w-100">Забыли пароль?</a>
                -->
        <hr class="my-4">
        <h6 class="text-center mb-4">Вход с помощью</h6>
        <div class="row row-cols-1 row-cols-sm-2">
          <div class="col mb-3">
            <!-- Google -->
            <a href="{{ url_for('google_login') }}" class="btn btn-icon btn-secondary btn-google btn-lg w-100">
              <i class="bx bxl-google"></i>
            </a>
          </div>
          <div class="col mb-3">
            <!-- VKontakte -->
            <a href="https://oauth.vk.com/authorize?client_id=51544060&display=page&redirect_uri=https://miminet.ru/auth/vk_callback&scope=friends,email&response_type=code&v=5.130"
              class="btn btn-icon btn-secondary btn-vk btn-lg w-100">
              <i class="bx bxl-vk"></i>
            </a>
          </div>
          <div class="col mb-3">
            <!-- Яндекс -->
            <!-- <a href="{{ url_for('yandex_login') }}" class="btn btn-icon btn-secondary btn-yandex btn-lg w-100">
                      <i class="bx bxl-yandex"> Яндекс</i>
                  </a> -->
            <div id="container"></div>
          </div>
          <div class="col mb-3">
            <!-- Госуслуги -->
            <a href="{{ url_for('yandex_login') }}" class="btn btn-icon btn-secondary btn-gs btn-lg w-100">
              <i class="bx bxl-gs"> Госуслуги</i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

</section>

<script>
  window.onload = function () {
    window.YaAuthSuggest.init(
      {
        client_id: '8a444254bd924731be51ae0e4729d4fc',
        response_type: 'token',
        redirect_uri: 'http://127.0.0.1:5000/auth/yandex_callback'
      },
      'http://127.0.0.1:5000/auth/yandex_token.html',
      {
        view: 'button',
        parentId: 'container',
        buttonView: 'main',
        buttonTheme: 'light',
        buttonSize: 'm',
        buttonBorderRadius: 0
      }
    )
      .then(function (result) {
        return result.handler();
      })
      .then(function (data) {
        console.log('Сообщение с токеном: ', data);
        // Добавьте следующую строку для перенаправления на домашнюю страницу
        window.location.href = 'http://127.0.0.1:5000/home';
      })
      .catch(function (error) {
        console.log('Что-то пошло не так: ', error);
        document.body.innerHTML += `Что-то пошло не так: ${JSON.stringify(error)}`;
      });
  };
</script>

{% endblock %}